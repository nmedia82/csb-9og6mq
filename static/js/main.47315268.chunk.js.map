{"version":3,"sources":["Images.jsx","Editor.js","Cursor.js","services/http.js","App.js","index.js"],"names":["Images","_ref","data","onImageSelect","react_default","a","createElement","className","map","img","i","key","onClick","src","concat","alt","Editor","CurrentImage","onImageChange","onImageSave","_useState","useState","_useState2","Object","slicedToArray","Canvas","setCavas","_useState3","_useState4","setCursor","_useState5","_useState6","DrawMode","setDrawMode","useEffect","canvas","fabric","isDrawingMode","freeDrawingCursor","cursor","StaticCanvas","freeDrawingBrush","width","color","mousecursor","Circle","left","top","radius","fill","stroke","originX","originY","id","add","on","evt","mouse","this","getPointer","e","set","y","x","setCoords","renderAll","Draw","refreshImage","img_url","clear","Image","fromURL","image","setBackgroundImage","bind","scaleX","scaleY","height","crossOrigin","handleDrawMode","mode","prototype","getItemByAttr","attr","name","object","objects","getObjects","len","size","text","Text","handleAddText","axios","interceptors","request","use","headers","common","error","Promise","reject","response","status","alert","http","get","post","put","delete","App","AllImages","setAllImages","setImage","ReadyImage","setReadyImage","asyncToGenerator","_regeneratorRuntime","mark","_callee","images","wrap","_context","prev","next","window","images_url","sent","files","stop","apply","arguments","loadImages","handleImageSelect","handleSaveImage","_ref2","_callee2","dataURL","filename","_context2","toDataURL","format","quality","image_data","saveimage_url","document","getElementById","innerHTML","_x","_x2","CheckMode","show","Fragment","rootElement","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.47315268.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\nexport default function Images({ data, onImageSelect }) {\r\n  return (\r\n    <div className=\"wooconvo-images\">\r\n      {data.map((img, i) => (\r\n        <div key={i}>\r\n          <img onClick={() => onImageSelect(img)} src={`${img}`} alt=\"logo\" />\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\nimport { fabric } from \"fabric\";\nimport { Draw } from \"./Cursor\";\n// import { FabricJSCanvas, useFabricJSEditor } from \"fabricjs-react\";\nimport \"./styles.css\";\n\nexport default function Editor({ CurrentImage, onImageChange, onImageSave }) {\n  const [Canvas, setCavas] = useState(null);\n  const [Cursor, setCursor] = useState(null);\n  const [DrawMode, setDrawMode] = useState(true);\n\n  useEffect(() => {\n    var canvas = new fabric.Canvas(\"draw\", {\n      isDrawingMode: true,\n      freeDrawingCursor: \"none\"\n    });\n    var cursor = Draw(canvas);\n    setCursor(cursor);\n    setCavas(canvas);\n\n    const loadImagezz = (img_url) => {\n      // editor.addRectangle();\n      canvas.clear();\n      var imgObj = new Image();\n      imgObj.src = img_url;\n      imgObj.onload = function () {\n        var image = new fabric.Image(imgObj, { crossOrigin: \"anonymous\" });\n        canvas.setBackgroundImage(image, canvas.renderAll.bind(canvas), {\n          scaleX: canvas.width / image.width,\n          scaleY: canvas.height / image.height\n        });\n      };\n    };\n\n    const loadImage = (img_url) => {\n      refreshImage(canvas, img_url);\n    };\n\n    loadImage(CurrentImage);\n  }, [CurrentImage]);\n\n  const refreshImage = (canvas, img_url) => {\n    canvas.clear();\n    fabric.Image.fromURL(\n      img_url,\n      function (image) {\n        //i create an extra var for to change some image properties\n        canvas.setBackgroundImage(image, canvas.renderAll.bind(canvas), {\n          scaleX: canvas.width / image.width,\n          scaleY: canvas.height / image.height\n        });\n      },\n      { crossOrigin: \"anonymous\" }\n    );\n  };\n\n  const handleDrawMode = (mode) => {\n    setDrawMode(mode);\n    Canvas.isDrawingMode = mode;\n    mode && Canvas.renderAll();\n    // !mode && Canvas.fabric.getItemByAttr(\"id\", \"mousecursor\").remove();\n  };\n\n  const handleReset = () => {\n    refreshImage(Canvas, CurrentImage);\n  };\n\n  fabric.Canvas.prototype.getItemByAttr = function (attr, name) {\n    var object = null,\n      objects = this.getObjects();\n    for (var i = 0, len = this.size(); i < len; i++) {\n      if (objects[i][attr] && objects[i][attr] === name) {\n        object = objects[i];\n        break;\n      }\n    }\n    return object;\n  };\n\n  const handleAddText = () => {\n    handleDrawMode(false);\n    var text = new fabric.Text(\"Your Text\", { left: 100, top: 100 });\n    Canvas.add(text);\n  };\n\n  return (\n    <div className=\"wooconvo-editor\">\n      <h1>FabricJS React Sample</h1>\n      <button\n        className=\"wooconvo-editor-btn\"\n        onClick={() => handleDrawMode(!DrawMode)}\n      >\n        Draw\n      </button>\n      <button className=\"wooconvo-editor-btn\" onClick={() => handleAddText()}>\n        Add Text\n      </button>\n      <button className=\"wooconvo-editor-btn\" onClick={() => handleReset()}>\n        Reset\n      </button>\n\n      <div id=\"wooconvo-canvases\">\n        <canvas\n          className=\"wooconvo-canvas\"\n          id=\"draw\"\n          width=\"350\"\n          height=\"350\"\n        ></canvas>\n        <canvas\n          className=\"wooconvo-canvas\"\n          id=\"cursor\"\n          width=\"350\"\n          height=\"350\"\n        ></canvas>\n        <button\n          className=\"wooconvo-editor-btn\"\n          onClick={() => onImageChange(null)}\n        >\n          Change Image\n        </button>\n        <button\n          className=\"wooconvo-editor-btn\"\n          onClick={() => onImageSave(Canvas, CurrentImage)}\n        >\n          Save Change\n        </button>\n      </div>\n    </div>\n  );\n}\n","/**\r\n * Credits: https://jsfiddle.net/Fidel90/7kmf3jz2/\r\n */\r\nimport { fabric } from \"fabric\";\r\n\r\nexport function Draw(canvas) {\r\n  var cursor = new fabric.StaticCanvas(\"cursor\");\r\n  canvas.freeDrawingBrush.width = 10;\r\n  canvas.freeDrawingBrush.color = \"#ff0000\";\r\n\r\n  var cursorOpacity = 0.5;\r\n  var mousecursor = new fabric.Circle({\r\n    left: -100,\r\n    top: -100,\r\n    radius: canvas.freeDrawingBrush.width / 3,\r\n    fill: \"rgba(255,0,0,\" + cursorOpacity + \")\",\r\n    stroke: \"black\",\r\n    originX: \"center\",\r\n    originY: \"center\",\r\n    id: \"mousecursor\"\r\n  });\r\n\r\n  cursor.add(mousecursor);\r\n\r\n  canvas.on(\"mouse:move\", function (evt) {\r\n    var mouse = this.getPointer(evt.e);\r\n    mousecursor\r\n      .set({\r\n        top: mouse.y,\r\n        left: mouse.x\r\n      })\r\n      .setCoords()\r\n      .canvas.renderAll();\r\n  });\r\n\r\n  canvas.on(\"mouse:out\", function () {\r\n    // put circle off screen\r\n    mousecursor\r\n      .set({\r\n        top: -100,\r\n        left: -100\r\n      })\r\n      .setCoords()\r\n      .canvas.renderAll();\r\n  });\r\n\r\n  return cursor;\r\n}\r\n\r\nexport function updateDrawMode(canvas, mode) {}\r\n","import axios from \"axios\";\r\n\r\naxios.interceptors.request.use(\r\n  function (request) {\r\n    request.headers.common[\"Content-Type\"] = \"application/json\";\r\n    // request.headers.common['Authorization'] = '***';\r\n    return request;\r\n  },\r\n  function (error) {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\naxios.interceptors.response.use(null, (error) => {\r\n  // console.log(\"Error\", error.response);\r\n  const expectedErrors =\r\n    error.response &&\r\n    error.response.status >= 400 &&\r\n    error.response.status < 500;\r\n\r\n  if (!expectedErrors) {\r\n    alert(\"An unexpected error occurred!\");\r\n  }\r\n\r\n  return Promise.reject(error);\r\n});\r\n\r\nexport default {\r\n  get: axios.get,\r\n  post: axios.post,\r\n  put: axios.put,\r\n  delete: axios.delete\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport Images from \"./Images\";\r\nimport Editor from \"./Editor\";\r\n\r\nimport http from \"./services/http\";\r\nimport data from \"./images/images.json\";\r\n\r\nwindow.images_url =\r\n  \"https://nmdevteam.com/wp1/wp-json/wooconvo/v1/get/photos/order/id/1532\";\r\nwindow.saveimage_url =\r\n  \"https://nmdevteam.com/wp1/wp-json/wooconvo/v1/upload/image\";\r\nexport default function App() {\r\n  const [AllImages, setAllImages] = useState([]);\r\n  const [Image, setImage] = useState(null);\r\n  const [ReadyImage, setReadyImage] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const loadImages = async () => {\r\n      var images = await http.get(window.images_url);\r\n      // console.log(images.data.files);\r\n      setAllImages(images.data.files);\r\n    };\r\n\r\n    loadImages();\r\n    // setAllImages(data);\r\n  }, []);\r\n\r\n  const handleImageSelect = (img) => {\r\n    // console.log(\"img\", img);\r\n    setImage(img);\r\n  };\r\n\r\n  const handleSaveImage = async (canvas, image) => {\r\n    const dataURL = canvas.toDataURL({\r\n      format: \"jpeg\",\r\n      quality: 0.8\r\n    });\r\n\r\n    var data = { image_data: dataURL, filename: image };\r\n    var response = await http.post(window.saveimage_url, data);\r\n    var filename = response.data.filename;\r\n    let files_list = document.getElementById(\"filelist-wooconvo_file\");\r\n    files_list.innerHTML =\r\n      '<input style=\"display:none\" checked=\"checked\" type=\"checkbox\" value=\"' +\r\n      filename +\r\n      '\" name=\"thefile_wooconvo_file[' +\r\n      filename +\r\n      ']\" />';\r\n\r\n    setReadyImage(dataURL);\r\n  };\r\n\r\n  const CheckMode = (mode) => {\r\n    var show = false;\r\n    switch (mode) {\r\n      case \"select\":\r\n        show = !Image && !ReadyImage;\r\n        break;\r\n      case \"editor\":\r\n        show = Image && !ReadyImage;\r\n        break;\r\n      case \"ready\":\r\n        show = ReadyImage;\r\n        break;\r\n      default:\r\n        show = false;\r\n    }\r\n    return show;\r\n  };\r\n\r\n  return (\r\n    <div className=\"wooconvo-img-editor-main\">\r\n      <div id=\"filelist-wooconvo_file\"></div>\r\n      <>\r\n        {CheckMode(\"select\") && (\r\n          <Images onImageSelect={handleImageSelect} data={AllImages} />\r\n        )}\r\n      </>\r\n      <>\r\n        {CheckMode(\"editor\") && (\r\n          <Editor\r\n            CurrentImage={Image}\r\n            onImageChange={handleImageSelect}\r\n            onImageSave={handleSaveImage}\r\n          />\r\n        )}\r\n\r\n        {CheckMode(\"ready\") && (\r\n          <div className=\"wooconvo-image-ready\">\r\n            <p>\r\n              <img src={ReadyImage} height=\"200\" width=\"200\" alt=\"Ready\" />\r\n            </p>\r\n            <button\r\n              className=\"wooconvo-editor-btn\"\r\n              onClick={() => setReadyImage(null)}\r\n            >\r\n              Change\r\n            </button>\r\n          </div>\r\n        )}\r\n      </>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  rootElement\n);\n"],"sourceRoot":""}